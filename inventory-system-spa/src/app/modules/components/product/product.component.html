<div class="container-xxl mt-5">
  <div class="row">
    <h2 class="mb-4">Products</h2>
    <span class="span-create" (click)="createProduct()">Add new item</span>
    <span class="span-create" (click)="createProduct()">Add new brand</span>
    <span class="span-create" (click)="createProduct()">Add new category</span>
  </div>
  <div class="row mb-3">
    <div class="col-md-6">
      <input type="text" class="form-control" placeholder="Search..." [(ngModel)]="searchTerm"
        (input)="filterProducts()">
    </div>
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-bordered">
      <thead class="thead-dark">
        <tr>
          <th scope="col"></th>
          <th scope="col">Code</th>
          <th scope="col">Name</th>
          <th scope="col">Description</th>
          <th scope="col">Category</th>
          <th scope="col">Brand</th>
          <th class="th-action" scope="col" width="150px"></th>
        </tr>
      </thead>
      <tbody>
        @for (product of paginatedProducts; track product.ProductId; let index = $index) {
        <tr>
          <th scope="row">{{ index + 1 + (currentPage - 1) * pageSize }}</th>
          <td>{{product.ProductCode}}</td>
          <td>{{product.ProductName}}</td>
          <td>{{product.ProductDescription}}</td>
          <td>{{product.Brand}}</td>
          <td>{{product.Category}}</td>
          <td width="150px" class="td-action">
            <button class="btn-edit" (click)="editProduct(product.ProductId)" role="button">Edit</button> 
              <button class="btn-delete" (click)="confirmDelete(product.ProductId)" role="button">Delete</button></td>
        </tr>
        }
        @empty {
        <tr>
          <td colspan="7" class="text-center">No available product.</td>
        </tr>
        }

      </tbody>
    </table>
  </div>
  <div class="row mt-3">
    <div class="col-md-12">
      <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
          <li class="page-item" [class.disabled]="currentPage === 1">
            <a class="page-link" (click)="changePage(currentPage - 1)">Prev</a>
          </li>
          <li class="page-item" *ngFor="let page of totalPagesArray" [class.active]="page === currentPage">
            <a class="page-link" (click)="changePage(page)">{{ page }}</a>
          </li>
          <li class="page-item" [class.disabled]="currentPage === totalPages">
            <a class="page-link" (click)="changePage(currentPage + 1)">Next</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>

<ng-template #toastTemplate> {{toastMessage}} </ng-template>

<ng-template #deleteConfirmation let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Confirm Delete</h5>
  </div>
  <div class="modal-body">
    <p>Are you sure you want to delete this product?</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="bsModalRef?.hide()">Cancel</button>
    <button type="button" class="btn btn-danger" (click)="deleteProduct()">Delete</button>
  </div>
</ng-template>